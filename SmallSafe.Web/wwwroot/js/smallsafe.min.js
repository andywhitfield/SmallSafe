function ssInitialise(){let n=$(window).width();$(window).on("resize",function(){let t=$(window).width();Math.abs(t-n)<2||(n=t,$("aside").css("display",""),$(".nav-close:visible").length>0&&($(".nav-close").css("display",""),$(".nav-show").css("display","")))});$(".nav-show").click(function(){$("aside").fadeToggle("fast");$(this).hide();$(".nav-close").show()});$(".nav-close").click(function(){$("aside").hide();$(this).hide();$(".nav-show").show()});$("[data-href]").click(function(n){return window.location.href=$(this).attr("data-href"),n.preventDefault(),!1});$("form[data-confirm]").submit(function(n){if(!confirm($(this).attr("data-confirm")))return n.preventDefault(),!1});$("button[data-clipboard]").click(function(){ssCopyToClipboard($(this).attr("data-clipboard"))});$('form[name="generatepassword"]').submit(function(n){return $.getJSON("/api/generatepassword?genpwmin="+$('form[name="generatepassword"] input[name="genpwmin"]').val()+"&genpwmax="+$('form[name="generatepassword"] input[name="genpwmax"]').val()+"&genpwnums="+($('form[name="generatepassword"] input[name="genpwnums"]').is(":checked")?"true":"false")+"&genpwallchars="+($('form[name="generatepassword"] input[name="genpwallchars"]').is(":checked")?"true":"false")+"").done(function(n){$(".generated-passwords").empty();n.forEach(n=>{let t=$(".generated-passwords").append('<div><button title="Copy password to the clipboard"><img src="/images/copy.png" height="15" width="15" /><\/button> <input type="text" /><\/div>');$("div:last button",t).attr("data-clipboard",n);$("div:last input",t).val(n)});$(".generated-passwords button[data-clipboard]").click(function(){ssCopyToClipboard($(this).attr("data-clipboard"))})}).fail(function(){$(".generated-passwords").empty();$(".generated-passwords").append("<div>Sorry, could not generate passwords. Please try again later.<\/div>")}),n.preventDefault(),!1});$('input[name="filter"]').on("keyup",function(){let n=$(this).val().trim().toUpperCase();console.log("filtering "+n);n===""?$("li.ss-list-item[data-filter]").show():$("li.ss-list-item[data-filter]").each(function(){$(this).attr("data-filter").toUpperCase().indexOf(n)===-1?$(this).hide():$(this).show()})});const t=new Proxy(new URLSearchParams(window.location.search),{get:(n,t)=>n.get(t)});let i=t.filter?t.filter.trim():"";i.trim()!==""&&$('input[name="filter"]').val(i).trigger("keyup");$("ul.ss-list").sortable({handle:".ss-list-item-drag-handle",isValidTarget:function(n,t){return t.el[0].className.includes("ss-list-item")},onDrop:function(n,t,i,r){i(n,t,r);let u=n.attr("data-group"),f=n.attr("data-entry");if(typeof u!="undefined"&&typeof f!="undefined"){let t=n.prev("li").attr("data-entry");console.log("moving group/entry "+u+"/"+f+" to be after "+t);typeof t=="undefined"&&(t=null);console.log("moving group "+u+" entry "+f+" to be after "+t);$.post("/api/group/"+u+"/entry/"+f+"/move",{prevEntryId:t}).done(function(){console.log("entry move successful")}).fail(function(){window.location.reload()})}else if(typeof u!="undefined"){let t=n.prev("li").attr("data-group");typeof t=="undefined"&&(t=null);console.log("moving group "+u+" to be after "+t);$.post("/api/group/"+u+"/move",{prevGroupId:t}).done(function(){console.log("group move successful")}).fail(function(){window.location.reload()})}}})}function ssInitialiseSafeEntry(){$(".ss-visible-value").hide();$("button.ss-show-value").click(function(){let n=$(this).parentsUntil("li.ss-list-item").parent(),t=n.attr("data-group"),i=n.attr("data-entry"),r=typeof n.attr("data-asof")!="undefined"?n.attr("data-asof"):"";$.getJSON("/api/group/"+t+"/entry/"+i+"?asof="+encodeURIComponent(r)).done(function(t){$("textarea",n).val(t.value);$(".ss-hidden-value",n).hide();$(".ss-visible-value",n).show()}).fail(function(){window.location.reload()})});$("button.ss-decrypt-value").click(function(){let n=$(this).parentsUntil("li.ss-list-item").parent(),t=n.attr("data-group"),i=n.attr("data-entry"),r=typeof n.attr("data-asof")!="undefined"?n.attr("data-asof"):"";$.getJSON("/api/group/"+t+"/entry/"+i+"?asof="+encodeURIComponent(r)).done(function(t){$("textarea",n).val(t.value);$("button.ss-decrypt-value",n).hide();$("button.ss-copy-value",n).show()}).fail(function(){window.location.reload()})});$("button.ss-hide-value").click(function(){let n=$(this).parentsUntil("li.ss-list-item");$(".ss-visible-value",n).hide();$("textarea",n).val("");$(".ss-hidden-value",n).show()});$("button.ss-copy-value").click(function(){let n=$(this).parentsUntil("li.ss-list-item");ssCopyToClipboard($("textarea",n).val());$(".ss-visible-value",n).hide();$("textarea",n).val("");$(".ss-hidden-value",n).show()});$("button.ss-save-value").click(function(){let n=$(this).parentsUntil("li.ss-list-item");$('textarea[name="newencryptedvalue"]').val($("textarea",n).val())})}function ssCopyToClipboard(n){navigator.clipboard?navigator.clipboard.writeText(n):ssFallbackCopyToClipboard(n)}function ssFallbackCopyToClipboard(n){let t=document.createElement("textarea");t.value=n;t.style.top="0";t.style.left="0";t.style.position="fixed";document.body.appendChild(t);t.focus();t.select();try{document.execCommand("copy")}catch(i){console.error("Unable to copy",i)}document.body.removeChild(t)}coerceToArrayBuffer=function(n,t){var r,u,i;if(typeof n=="string"){for(n=n.replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),u=new Uint8Array(r.length),i=0;i<r.length;i++)u[i]=r.charCodeAt(i);n=u}if(Array.isArray(n)&&(n=new Uint8Array(n)),n instanceof Uint8Array&&(n=n.buffer),!(n instanceof ArrayBuffer))throw new TypeError("could not coerce '"+t+"' to ArrayBuffer");return n};coerceToBase64Url=function(n){var i,r,t;if(Array.isArray(n)&&(n=Uint8Array.from(n)),n instanceof ArrayBuffer&&(n=new Uint8Array(n)),n instanceof Uint8Array){for(i="",r=n.byteLength,t=0;t<r;t++)i+=String.fromCharCode(n[t]);n=window.btoa(i)}if(typeof n!="string")throw new Error("could not coerce to string");return n.replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/g,"")};